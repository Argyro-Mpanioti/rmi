# rmi

## Κλάση Account

Η κλάση Account χρησιμοποιείται για την παραγωγή αντικειμένων που αντιπροσωπεύουν λογαριασμούς.

### Πεδία
Η κλάση έχει ως πεδία:
* το String username, που είναι το username του λογαριασμού
* το ακέραιο authToken, που είναι ένας ακέραιος αριθμός που δίνεται στον λογαριασμό
* τη λίστα messageBox, που περιέχει τα μηνύματα που έχει λάβει ο λογαρισμός.

Κάθε λογαριασμός έχει διαφορετικό authToken.

### Μέθοδοι
Η κλάση εχει έναν κατασκευαστή που δέχεται το username και το authToken ως παραμέτρους και αρχικοποιεί με αυτά τα αντίστοιχα πεδία και επίσης αρχικοποιεί το messageBox σε μία κενή λίστα.


## Κλάση Message

Η κλάση Message χρησιμοποιείται για την παραγωγή αντικειμένων που αντιπροσωπεύουν μηνύματα.

### Πεδία
Η κλάση έχει ως πεδία:
* το boolean isRead, που έχει την τιμή true μόνο όταν το μήνυμα έχει διαβαστεί
* το String sender, που περιέχει το username του αποστολέα του μηνύματος
* το String receiver, που περιέχει το username του παραλήπτη του μηνύματος
* το String body, που περιέχει το κείμενο του μηνύματος
* το ακέραιο id, που είναι ένας ακέραιος αριθμός που δίνεται στο μήνυμα.

Κάθε μήνυμα έχει ξεχωριστό id.

### Μέθοδοι
Η κλάση έχει μία μέθοδο info η οποία επιστρέφει ένα String που δείχνει τις πληροφορίες του μηνύματος με την μορφή id. from: sender* αν δεν έχει διαβαστεί ακόμη και id. from: sender αν έχει διαβαστεί.

Παραδείγματος χάρην: αν το μήνυμά μας έχει id 5, αποστολέα τον χρήστη με username thisUser και δεν έχει διαβαστεί τότε επιστρέφεται το εξής: 5. from: thisUser* 

Επίσης έχει έναν κατασκευαστή που δέχεται το username του sender, το username του receiver, το κείμενο και το id ως παραμέτρους και αρχικοποιεί με αυτά τα αντίστοιχα πεδία και επίσης αρχικοποιεί το isRead ως false.


## Κλάση MessagingServer

Η κλάση MessagingServer υλοποιεί την υπηρεσία του server.

### Πεδία

Η κλάση περιέχει ως πεδία:
* την λίστα accounts, που περιέχει όλους τους λογαριασμούς που δημιουργούνται ενώ τρέχει ο server
* το ακέραιο authTokensCounter, που αυξάνεται κατά 1 κάθε φορά που δημιουργείται ενας νέος λογαριασμός και γίνεται το authToken του λογαριασμού αυτού
* το ακέραιο messageIdsCounter, που αυξάνεται κατά 1 κάθε φορά που δημιουργείται ενα νέο μήνυμα και γίνεται το id του μηνύματος αυτού

Όλα τα παραπάνω πεδία είναι global γιατί χρειαζόμαστε πρόσβαση σε αυτά από την κλάση RemoteMessagingApp.

### Μέθοδοι

Η κλάση έχει μία μέθοδο main η οποία αρχικοποιεί το accounts σε μία κενή λίστα, το authTokensCounter σε 0 και το messageIdsCounter σε 0. Επίσης, ορίζει ως portNumber την 1η παράμετρο με την οποία τρέχουμε τον server. Στη συνέχεια φτιάχνει το remote αντικείμενο stub, δημιουργεί registry στην θύρα portNumber και το συνδέει με το stub με όνομα "messaging".


## Κλάση MessagingClient

Η κλάση MessagingClient υλοποιεί την υπηρεσία του client.

### Μέθοδοι

Η κλάση έχει μία μέθοδο main η οποία ορίζει ως ip την 1η παράμετρο με την οποία τρέχουμε τον client, ως portNumber την 2η παράμετρο με την οποία τρέχουμε τον client, ως FN_ID την 3η παράμετρο με την οποία τρέχουμε τον client και αποθηκεύει τις υπόλοιπες παραμέτρους με τις οποίες τρέχουμε τον client στον πίνακα argsRest. Στη συνέχεια βρίσκει το registry της θύρας portNumber και φτιάχνει το remote αντικείμενο stub με αναζήτηση του ονόματος "messaging" στο registry. Έπειτα, η main καλεί την DoFN_ID με παραμέτρους το stub, το FN_ID και τον πίνακα argsRest και εκτυπώνει το αποτέλεσμά της.

Η μέθοδος DoFN_ID εκτελεί την διεργασία που δηλώνει το ακέρσιο FN_ID το οποίο δέχεται ως παράμετρο με βάση τις υπόλοιπες παραμέτρους argsRest. Αυτό το κάνει καλώντας την αντίστοιχη μέθοδο του stub που δηλώνεται στο interface MessagingAppInt και υλοποιείται στην κλάση RemoteMessagingApp και αποθηκεύοντας το μήνυμα που επιστρέφει κάθε μέθοδος. Σε περίπτωση που το FN_ID είναι διάφορο του 1, δηλαδή δεν δημιουργείται λογαριασμός αλλά εκτελούμε ενέργεια από λογαριασμό που ήδη υπάρχει τότε γίνεται πρώτα έλεγχος αν το authToken αντιστοιχεί σε κάποιον υπάρχοντα λογαριασμό. Αν όχι, τότε επιστρέφεται το μήνυμα "Invalid Auth Token".


## Interface MessagingAppInt

Το interface MessagingAppInt περιέχει τις δηλώσεις των συναρτήσεων που καλεί ο client και υλοποιεί ο server στην κλάση RemoteMessagingApp.


## Κλάση RemoteMessagingApp

Η κλάση RemoteMessagingApp υλοποιεί τις μεθόδους του interface MessagingAppInt.

### Μέθοδοι

Οι μέθοδοι που υπάρχουν είναι:
* ένας κενός κατασκευαστής που καλεί τον κατασκευαστή της UnicastRemoteObject
* IsUsernameValid: Δέχεται ως παράμετρο ένα username και επιστρέφει true αν και μόνο αν το username περιέχει μόνο αλφαριθμητικά και τον ειδικό χαρακτήρα "\_". Αυτό ελέγχεται με τον εξής τρόπο: γίνεται αντικατάσταση των αλφαριθμητικών και των χαρακτήρων "\_" με το κενό και ελέγχεται αν το username είναι κενό. 
* CreateAccount: Η μέθοδος CreateAcccount δέχεται ένα String username και προσπαθεί να δημιουργήσει έναν λογαριασμό με αυτό το username και επιστρέφει ένα String output. Αν το username περιέχει χαρακτήρες που δεν είναι αλφαριθμητικα ή ο ειδικός χαρακτήρας "/_" τότε δεν δημιουργείται λογαριασμός και επιστρέφεται το output "Invalid Username". Αν όχι, τότε ελέγχεται αν υπάρχει ήδη λογαριασμός στην global λίστα με τους λογαριασμούς accounts του MessagingServer. Αν υπάρχει λογαριασμός με αυτό το username τότε επιστρέφεται το output "Sorry, the user already exists". Αλλιώς αυξάνεται ο global μετρητής των λογαριασμών authTokensCounter του MessagingServer κατά 1, δημιουργείται νέος λογαριασμός με το username ως username και το authTokensCounter ως authToken, ο νέος λογαριασμός προστίθεται στην global λίστα με τους λογαριασμούς accounts του MessagingServer και επιστρέφεται το authToken ως String στο output.




















